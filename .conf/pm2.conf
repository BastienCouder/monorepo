# Installer PM2 globalement sur votre système
npm install -g pm2

# Démarrer une application Node.js avec PM2 en utilisant npm
# Remplacez "app" par le nom que vous souhaitez donner à votre processus
pm2 start npm --name "app" -- start

# Lister toutes les applications gérées par PM2
pm2 list

# Arrêter une application spécifique en utilisant son ID ou son nom
pm2 stop <id_ou_nom>

# Redémarrer une application spécifique en utilisant son ID ou son nom
pm2 restart <id_ou_nom>

# Supprimer une application de la liste des processus gérés par PM2
pm2 delete <id_ou_nom>

# Surveiller en temps réel l'utilisation des ressources (CPU, mémoire) des applications
pm2 monit

# Afficher les logs en temps réel d'une application spécifique
pm2 logs <id_ou_nom>

# Afficher les 100 dernières lignes des logs d'une application spécifique
pm2 logs <id_ou_nom> --lines 100

# Sauvegarder la liste actuelle des processus pour qu'ils redémarrent automatiquement au redémarrage du serveur
pm2 save

# Configurer PM2 pour démarrer automatiquement au démarrage du système
pm2 startup

# Mettre à jour PM2 vers la dernière version
npm install -g pm2@latest
pm2 update

# Arrêter tous les processus gérés par PM2
pm2 stop all

# Supprimer tous les processus de PM2
pm2 delete all

# Redémarrer tous les processus gérés par PM2
pm2 restart all

# Exemple de fichier de configuration PM2 (ecosystem.config.js) pour gérer plusieurs applications
module.exports = {
  apps: [
    {
      name: "mon-app",        # Nom de l'application
      script: "app.js",       # Point d'entrée de l'application
      instances: 2,           # Nombre d'instances à démarrer
      autorestart: true,      # Redémarrer automatiquement en cas de crash
      watch: false,           # Ne pas surveiller les changements de fichiers
      env: {
        NODE_ENV: "production",  # Environnement de production
      },
    },
  ],
};

# Démarrer les applications définies dans le fichier de configuration ecosystem.config.js
pm2 start ecosystem.config.js

# Afficher le statut général de PM2 et des applications gérées
pm2 status

# Redémarrer tous les processus gérés par PM2 (utile après une modification de configuration)
pm2 restart all